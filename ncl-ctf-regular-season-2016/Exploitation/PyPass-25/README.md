# NCL 2016 : PyPass-25

__Category__: Exploitation

__Points__: 25

## Write-up

<a href="https://jhalon.github.io/images/nclp-6.png"><img src="https://jhalon.github.io/images/nclp-6.png"></a>

For this challenge we are provided the following file: [NCL-2016-Game2-pypass.pyc](https://jhalon.github.io/download/NCL-2016-Game2-pypass.pyc)

--

__What is the hidden flag?__

For this question you needed some previous experience with reverse engineering, and python. Looking at the file that is provided to us, we see the extension is __.pyc__, which is Compiled Python Code.

To be able to disassemble the compiled code we need to use the tool [uncompyle2](https://github.com/wibiti/uncompyle2) which is a Python 2.7 byte-code decompiler.

Once you install the tool, run the following command with the file provided and we should get the disassembled code.

```console
root@kali:~/Downloads# uncompyle2 NCL-2016-Game2-pypass.pyc 
# 2016.11.20 16:24:15 CST
#Embedded file name: ./pypass.py
import sys
keys = ['a',
 'b',
 'c',
 'd',
 'e',
 'f',
 'g',
 'h',
 'i',
 'j',
 'k',
 'l',
 'm',
 'n',
 'o',
 'p',
 'q',
 'r',
 's',
 't',
 'u',
 'v',
 'w',
 'x',
 'y',
 'z',
 '0',
 '1',
 '2',
 '3',
 '4',
 '5',
 '6',
 '7',
 '8',
 '9']

def main():
    if False:
        print keys[13].upper() + keys[2].upper() + keys[11].upper() + '-' + keys[27] + keys[30] + keys[32] + keys[29] + '-' + keys[21].upper() + keys[18].upper() + keys[3].upper() + keys[9].upper()


if __name__ == '__main__':
    main()
+++ okay decompyling NCL-2016-Game2-pypass.pyc 
# decompiled 1 files: 1 okay, 0 failed, 0 verify failed
# 2016.11.20 16:24:15 CST
```

Cool! Now that we have our hands on the code, we see that the program takes a letter from the list "keys" and prints it out, while converting it to upper case.

Since we have the code, all we really have to do is reverse engineer it - more like re-engineer it - to give us the answer. Let's begin by opening __gedit__ with a new file name called __pass.py__.

```console
root@kali:~/Downloads# gedit pass.py
```

Once we open our new file, let's go ahead and write the following Python code. Notice how I included __#!/usr/bin/python__, so that our Terminal will run the code with Python and avoid any errors. At the same time I removed __def main():__ from the code and just allowed Python to print the characters for us, without us having to call the __main__ function.

```python
#!/usr/bin/python

import sys
keys = ['a',
 'b',
 'c',
 'd',
 'e',
 'f',
 'g',
 'h',
 'i',
 'j',
 'k',
 'l',
 'm',
 'n',
 'o',
 'p',
 'q',
 'r',
 's',
 't',
 'u',
 'v',
 'w',
 'x',
 'y',
 'z',
 '0',
 '1',
 '2',
 '3',
 '4',
 '5',
 '6',
 '7',
 '8',
 '9']


print keys[13].upper() + keys[2].upper() + keys[11].upper() + '-' + keys[27] + keys[30] + keys[32] + keys[29] + '-' + keys[21].upper() + keys[18].upper() + keys[3].upper() + keys[9].upper()
```

Once we save that code, let's go ahead and give it executable permissions, and then run the code. We should thus get the hidden flag!

```console
root@kali:~/Downloads# chmod +x pass.py 
root@kali:~/Downloads# ./pass.py 
NCL-1463-VSDJ
```

__Answer: NCL-1463-VSDJ__

--

## Other Write-ups and Resources

* [Jack Halon - KKB](https://jhalon.github.io/ncl-regular-season-2/)
