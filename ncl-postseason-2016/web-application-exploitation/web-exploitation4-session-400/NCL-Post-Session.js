function defaultSession() {
  return '{"username":"guest","secret":"84983c60f7daadc1cb8698621f802c0d9f9a3c3c295c810748fb048115c186ec"}';
}

function obtainSession(sessionCiphertext) {
  var ciphertext = Buffer.from(sessionCiphertext);
  var cipher = crypto.createCipher('aes-128-ctr', PSK);
  var blocks = cipher.update(Buffer.alloc(ciphertext.length, 0x00));
  var plaintext = XOR(ciphertext, blocks);
  return JSON.parse(plaintext);
}

function validateSession(sessionCiphertext, sessionHmac) { // delimited by -
  
  var session = obtainSession(sessionCiphertext);
  if (!session) {
    return false;
  }
  var hmac = crypto.createHmac('sha256', session.secret);
  hmac.update(sessionCiphertext);
  if (hmac.digest() !== sessionHmac) {
    return false;
  }

  return true;
}
